{{- $header := partial "header.html" . | jsonify -}}
{{- $footer := partial "footer.html" . | jsonify -}}
{{- $js := printf `// Ethmarks Web Components
// Generated automatically from Hugo partials

class EthmarksHeader extends HTMLElement {
  connectedCallback() {
    this.innerHTML = %s;

    const activeLink = this.getAttribute('active');
    if (activeLink) {
      // Remove any existing active classes
      const navLinks = this.querySelectorAll('nav a');
      navLinks.forEach(link => link.classList.remove('active'));

      // Add active class to the specified link by ID
      const targetLink = this.querySelector('#nav-' + activeLink.toLowerCase());
      if (targetLink) {
        targetLink.classList.add('active');
      }
    }
  }
}

class EthmarksFooter extends HTMLElement {
  connectedCallback() {
    this.innerHTML = %s;

    const sourceLink = this.getAttribute('source');
    if (sourceLink) {
      const sourceAnchor = this.querySelector('a#sourcelink');
      if (sourceAnchor) {
        sourceAnchor.href = sourceLink;
      }
    }

    function updateOverflowClasses() {
      const heightOverflowClass = "height-overflow";
      const body = document.body;
      const containerHeight = window.innerHeight;
      const contentHeight = Math.max(
        document.documentElement.scrollHeight,
        document.body.scrollHeight
      );

      if (contentHeight === 0) { return; }

      if (contentHeight > containerHeight) {
        body.classList.add(heightOverflowClass);
      } else {
        body.classList.remove(heightOverflowClass);
      }
    }

    const resizeObserver = new ResizeObserver(() => {
      updateOverflowClasses();
    });

    resizeObserver.observe(document.body);
    updateOverflowClasses();
  }
}

// Register the custom elements
customElements.define('ethmarks-header', EthmarksHeader);
customElements.define('ethmarks-footer', EthmarksFooter);
` $header $footer -}}
{{- $resource := resources.FromString "js/ethmarks-components.js" $js -}}
{{- $resource.Publish -}}
